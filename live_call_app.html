<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Live Connect - Find a Spark</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(60deg, #d81b60, #ff4081, #f50057);
            --dark-bg: #110f1a;
            --light-bg: #1e1b2e;
            --text-color: #f5f5f5;
            --text-muted: #b0aed4;
        }
        body, html { margin: 0; padding: 0; height: 100%; font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; background-color: var(--dark-bg); color: var(--text-color); overflow: hidden; }
        #background-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        .screen { position: absolute; top: 0; left: 0; display: flex; width: 100%; height: 100%; flex-direction: column; justify-content: center; align-items: center; text-align: center; box-sizing: border-box; padding: 20px; z-index: 1; background-color: rgba(17, 15, 26, 0.5); opacity: 0; visibility: hidden; transition: opacity 0.5s ease, visibility 0.5s ease; }
        .active-screen { opacity: 1; visibility: visible; }
        
        /* Start & Permission Screens */
        #start-screen h1, #permission-screen h1 { font-size: 3.2em; background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 10px; font-weight: 700; }
        #start-screen p, #permission-screen p { color: var(--text-muted); font-size: 1.1em; max-width: 300px; }
        .action-button { padding: 18px 50px; font-size: 1.2em; font-weight: 600; background: var(--primary-gradient); background-size: 200%; color: white; border: none; border-radius: 50px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 5px 20px #f5005740; margin-top: 30px; }
        .action-button:hover { transform: translateY(-3px); box-shadow: 0 8px 25px #f5005760; background-position: right; }

        /* Connecting Screen */
        .radar-scanner { position: relative; width: 180px; height: 180px; margin-bottom: 40px; }
        .radar-scanner .profile-pic { width: 100%; height: 100%; border-radius: 50%; border: 4px solid #f50057; box-shadow: 0 0 30px #f5005780; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(0.95); box-shadow: 0 0 0 0 #f5005780; } 70% { transform: scale(1); box-shadow: 0 0 0 15px rgba(245,0,87,0); } 100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(245,0,87,0); } }
        #connecting-screen h2 { color: var(--text-muted); }

        /* Call Screen */
        #call-screen { background: none; }
        .video-container { position: absolute; top:0; left:0; width: 100%; height: 100%; z-index: -1; }
        #remote-video { width: 100%; height: 100%; object-fit: cover; }
        .local-video-wrapper { position: absolute; bottom: 140px; right: 20px; width: 120px; height: 180px; background-color: #000; border: 2px solid #fff; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); overflow: hidden; }
        #local-video { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }
        #video-off-placeholder { width: 100%; height: 100%; display: none; justify-content: center; align-items: center; background-color: #222; }
        #video-off-placeholder svg { width: 50px; height: 50px; fill: #666; }
        .call-info { position: absolute; top: 30px; left: 20px; text-align: left; }
        #stranger-name { font-size: 1.5em; font-weight: bold; text-shadow: 0 2px 5px #000; }
        #stranger-location { font-size: 1em; color: var(--text-muted); text-shadow: 0 2px 5px #000; }
        #call-timer { position: absolute; top: 30px; right: 20px; background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 20px; backdrop-filter: blur(5px); }
        .call-controls { position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%); display: flex; gap: 15px; background: rgba(0,0,0,0.4); padding: 10px; border-radius: 50px; backdrop-filter: blur(10px); }
        .control-button { width: 55px; height: 55px; display: flex; justify-content: center; align-items: center; border: none; border-radius: 50%; cursor: pointer; background-color: rgba(255,255,255,0.2); }
        #end-call-btn { background: var(--primary-gradient); }
        .control-button svg { width: 26px; height: 26px; fill: white; }
        .heart-animation { position: absolute; bottom: 120px; left: calc(50% + 100px); font-size: 30px; animation: fly-up 2s ease-out forwards; opacity: 1; pointer-events: none; }
        @keyframes fly-up { to { transform: translateY(-300px); opacity: 0; } }

        /* End Screen */
        #end-screen h2 { font-size: 2.5em; }

    </style>
</head>
<body>
    <canvas id="background-canvas"></canvas>
    <div id="start-screen" class="screen active-screen"><h1>Live Connect</h1><p>Find your Spark. Connect with someone new instantly.</p><button id="start-call-btn" class="action-button">Start</button></div>
    <div id="permission-screen" class="screen"><h1>Camera Access</h1><p>Is app ko istemal karne ke liye, camera aur mic ki ijazat zaroori hai. Please refresh karke ijazat dein.</p></div>
    <div id="connecting-screen" class="screen"><div class="radar-scanner"><img class="profile-pic" src="https://www.w3schools.com/howto/img_avatar.png" alt="Searching"></div><h2>Searching for someone special...</h2></div>
    
    <div id="call-screen" class="screen">
        <div class="video-container"><video id="remote-video" playsinline loop muted></video></div>
        <div class="local-video-wrapper"><video id="local-video" autoplay muted playsinline></video><div id="video-off-placeholder"><svg viewBox="0 0 24 24"><path d="M12,12A3,3 0,0,0,9,9C9,7.35,10.35,6,12,6C13.65,6,15,7.35,15,9C15,10.65,13.65,12,12,12M12,4A5,5 0,0,1,17,9C17,11.38,15.19,13.47,12.86,13.88C15.89,14.53,18,17.03,18,20V22H6V20C6,17.03,8.11,14.53,11.14,13.88C8.81,13.47,7,11.38,7,9A5,5 0,0,1,12,4Z"/></svg></div></div>
        <div class="call-info"><div id="stranger-name"></div><div id="stranger-location"></div></div>
        <div id="call-timer">00:00</div>
        <div class="call-controls">
            <button id="video-off-btn" class="control-button" title="Stop Video"><svg viewBox="0 0 24 24"><path d="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"/></svg></button>
            <button id="end-call-btn" class="control-button" title="End Call"><svg viewBox="0 0 24 24"><path d="M12,9C10.4,9 8.85,9.25 7.4,9.72V12.82C7.4,13.22 7.17,13.56 6.84,13.72C5.86,14.21 4.97,14.84 4.19,15.57C4,15.75 3.75,15.86 3.5,15.86C3.2,15.86 2.95,15.74 2.77,15.56L0.29,13.08C0.11,12.9 0,12.65 0,12.38C0,12.11 0.11,11.86 0.29,11.68C3.33,8.76 7.46,7 12,7C16.54,7 20.67,8.76 23.71,11.68C23.89,11.86 24,12.11 24,12.38C24,12.65 23.89,12.9 23.71,13.08L21.23,15.56C21.05,15.74 20.8,15.86 20.5,15.86C20.25,15.86 20,15.75 19.81,15.57C19.03,14.84 18.14,14.21 17.16,13.72C16.83,13.56 16.6,13.22 16.6,12.82V9.72C15.15,9.25 13.6,9 12,9Z"/></svg></button>
            <button id="mute-btn" class="control-button" title="Mute"><svg viewBox="0 0 24 24"><path d="M12,1A3,3 0 0,0 9,4V10A3,3 0 0,0 12,13A3,3 0 0,0 15,10V4A3,3 0 0,0 12,1M19,10C19,13.89 15.91,17.13 12,17.5V21H17V23H7V21H12V17.5C8.09,17.13 5,13.89 5,10H7C7,12.76 9.24,15 12,15C14.76,15 17,12.76 17,10H19Z"/></svg></button>
            <button id="send-heart-btn" class="control-button" title="Send Heart">❤️</button>
        </div>
    </div>
    <div id="end-screen" class="screen"><h2>Connection Lost</h2><p>Let's find someone new for you.</p><button id="call-again-btn" class="action-button">Search Again</button></div>

    <script>
        const canvas = document.getElementById('background-canvas'), ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth, canvas.height = window.innerHeight;
        let particlesArray = []; const numberOfParticles = 50;
        class Particle { constructor() { this.x = Math.random() * canvas.width, this.y = Math.random() * canvas.height, this.size = Math.random() * 2 + 1, this.speedX = Math.random() * 1 - 0.5, this.speedY = Math.random() * 1 - 0.5, this.color = `rgba(245, 0, 87, ${Math.random()})` } update() { if (this.x > canvas.width || this.x < 0) this.speedX = -this.speedX; if (this.y > canvas.height || this.y < 0) this.speedY = -this.speedY; this.x += this.speedX, this.y += this.speedY } draw() { ctx.fillStyle = this.color, ctx.beginPath(), ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2), ctx.fill() } }
        function initParticles() { for (let i = 0; i < numberOfParticles; i++) particlesArray.push(new Particle()) }
        function animateParticles() { ctx.clearRect(0, 0, canvas.width, canvas.height); for (let i = 0; i < particlesArray.length; i++) particlesArray[i].update(), particlesArray[i].draw(); requestAnimationFrame(animateParticles) }
        initParticles(), animateParticles(), window.addEventListener('resize', () => { canvas.width = window.innerWidth, canvas.height = window.innerHeight, particlesArray = [], initParticles() });
        const screens = { start: document.getElementById('start-screen'), permission: document.getElementById('permission-screen'), connecting: document.getElementById('connecting-screen'), call: document.getElementById('call-screen'), end: document.getElementById('end-screen') }, localVideo = document.getElementById('local-video'), remoteVideo = document.getElementById('remote-video'), strangerName = document.getElementById('stranger-name'), strangerLocation = document.getElementById('stranger-location'), callTimer = document.getElementById('call-timer'), startCallBtn = document.getElementById('start-call-btn'), endCallBtn = document.getElementById('end-call-btn'), callAgainBtn = document.getElementById('call-again-btn'), muteBtn = document.getElementById('mute-btn'), videoOffBtn = document.getElementById('video-off-btn'), sendHeartBtn = document.getElementById('send-heart-btn'), videoOffPlaceholder = document.getElementById('video-off-placeholder');
        let localStream, timerInterval;
        const preRecordedVideos = ['https://github.com/AhmadAbbas75/Live-Call-App/raw/refs/heads/main/videoplayback.mp4'];
        const fakeData = [{ name: 'Jessica', location: 'USA' }, { name: 'Aisha', location: 'India' }, { name: 'Sofia', location: 'Brazil' }, { name: 'Ali', location: 'Pakistan' }, { name: 'Kenji', location: 'Japan' }, { name: 'Fatima', location: 'Egypt' }, { name: 'Isabella', location: 'Italy' }, { name: 'Omar', location: 'UAE' }];
        function showScreen(screenName) { Object.values(screens).forEach(s => s.classList.remove('active-screen')), screens[screenName].classList.add('active-screen') }
        async function startLocalVideo() { try { if (localStream) localStream.getTracks().forEach(track => track.stop()); localStream = await navigator.mediaDevices.getUserMedia({ video: !0, audio: !0 }), localVideo.srcObject = localStream } catch (e) { showScreen('permission'); throw e } }
        function startTimer() { let seconds = 0; callTimer.textContent = "00:00", timerInterval = setInterval(() => { seconds++; const mins = String(Math.floor(seconds / 60)).padStart(2, '0'), secs = String(seconds % 60).padStart(2, '0'); callTimer.textContent = `${mins}:${secs}` }, 1000) }
        async function startCall() { showScreen('connecting'); try { await startLocalVideo(), setTimeout(() => { const randomVideo = preRecordedVideos[Math.floor(Math.random() * preRecordedVideos.length)], randomProfile = fakeData[Math.floor(Math.random() * fakeData.length)]; remoteVideo.src = randomVideo, remoteVideo.play(), strangerName.textContent = randomProfile.name, strangerLocation.textContent = randomProfile.location, showScreen('call'), startTimer() }, 3000) } catch (error) {} }
        function endCall() { if (localStream) localStream.getTracks().forEach(track => track.stop()); remoteVideo.pause(), clearInterval(timerInterval), showScreen('end') }
        function toggleTrack(kind) { if (!localStream) return; const track = localStream.getTracks().find(t => t.kind === kind); if (track) track.enabled = !track.enabled; const btn = (kind === 'audio') ? muteBtn : videoOffBtn; btn.classList.toggle('active', !track.enabled); if (kind === 'video') videoOffPlaceholder.style.display = track.enabled ? 'none' : 'flex' }
        function sendHeart() { const heart = document.createElement('div'); heart.classList.add('heart-animation'), heart.innerText = '❤️', screens.call.appendChild(heart), setTimeout(() => heart.remove(), 2000) }
        startCallBtn.addEventListener('click', startCall), endCallBtn.addEventListener('click', endCall), callAgainBtn.addEventListener('click', startCall), muteBtn.addEventListener('click', () => toggleTrack('audio')), videoOffBtn.addEventListener('click', () => toggleTrack('video')), sendHeartBtn.addEventListener('click', sendHeart);
    </script>
</body>
</html>